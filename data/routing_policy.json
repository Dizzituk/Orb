{
  "policy_version": "1.0.0",
  "schema_version": "2025-12-01",
  "description": "Orb multi-LLM routing policy - deterministic API routing and data-handling rules",

  "providers": {
    "openai": {
      "display_name": "GPT",
      "model": "gpt-4o",
      "streaming_model": "gpt-4o",
      "embedding_model": "text-embedding-3-small",
      "max_context_tokens": 128000,
      "max_output_tokens": 16384,
      "supports_streaming": true,
      "supports_vision": false,
      "supports_web_search": false,
      "allowed_data": ["text", "code", "logs", "structured_json", "embeddings_request"],
      "forbidden_data": ["images", "videos", "audio", "large_codebase"],
      "max_chars_input": 400000
    },
    "anthropic": {
      "display_name": "Claude",
      "model": "claude-sonnet-4-20250514",
      "streaming_model": "claude-sonnet-4-20250514",
      "max_context_tokens": 200000,
      "max_output_tokens": 64000,
      "supports_streaming": true,
      "supports_vision": false,
      "supports_web_search": false,
      "allowed_data": ["text", "code", "logs", "structured_json", "large_codebase", "design_docs"],
      "forbidden_data": ["images", "videos", "audio"],
      "max_chars_input": 600000
    },
    "gemini": {
      "display_name": "Gemini",
      "model": "gemini-2.0-flash",
      "streaming_model": "gemini-2.0-flash",
      "vision_model": "gemini-2.0-flash",
      "max_context_tokens": 1000000,
      "max_output_tokens": 8192,
      "supports_streaming": true,
      "supports_vision": true,
      "supports_web_search": true,
      "allowed_data": ["text", "code", "logs", "structured_json", "images", "videos", "pdfs", "screenshots", "audio"],
      "forbidden_data": [],
      "max_chars_input": 2000000
    }
  },

  "data_types": {
    "text": { "description": "Plain text, markdown, prose", "mime_prefixes": ["text/"] },
    "code": { "description": "Source code files", "extensions": [".py", ".js", ".ts", ".java", ".c", ".cpp", ".go", ".rs", ".rb", ".php", ".swift", ".kt"] },
    "logs": { "description": "Log files, stack traces, error output", "extensions": [".log", ".txt"], "patterns": ["traceback", "exception", "error"] },
    "structured_json": { "description": "JSON, YAML, TOML config files", "extensions": [".json", ".yaml", ".yml", ".toml"] },
    "images": { "description": "Image files", "mime_prefixes": ["image/"] },
    "videos": { "description": "Video files", "mime_prefixes": ["video/"] },
    "audio": { "description": "Audio files", "mime_prefixes": ["audio/"] },
    "pdfs": { "description": "PDF documents", "mime_types": ["application/pdf"] },
    "screenshots": { "description": "Screen captures for UI analysis", "mime_prefixes": ["image/"] },
    "large_codebase": { "description": "Multi-file code context >50KB", "min_bytes": 51200 },
    "design_docs": { "description": "Architecture/design documents", "keywords": ["architecture", "design", "spec", "rfc"] },
    "embeddings_request": { "description": "Request for vector embeddings generation", "internal": true }
  },

  "defaults": {
    "primary_provider": "openai",
    "review_provider": null,
    "include_semantic_context": true,
    "include_web_search": false,
    "include_attachments": "text_only",
    "max_chars_to_provider": 100000,
    "timeout_seconds": 120,
    "retry_count": 2,
    "temperature": 0.7
  },

  "entries": [
    {
      "job_type": "casual_chat",
      "description": "General conversation, greetings, small talk",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "none",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "logs"],
      "max_chars_to_provider": 8000,
      "temperature": 0.8
    },
    {
      "job_type": "quick_question",
      "description": "Simple factual questions, definitions, lookups",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "none",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "large_codebase"],
      "max_chars_to_provider": 16000,
      "temperature": 0.5
    },
    {
      "job_type": "thought_organization",
      "description": "Brainstorming, outlining, structuring ideas",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "structured_json"],
      "forbidden_data": ["images", "large_codebase"],
      "max_chars_to_provider": 32000,
      "temperature": 0.7
    },
    {
      "job_type": "summarization",
      "description": "Summarizing documents, notes, conversations",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "structured_json", "logs"],
      "forbidden_data": ["images", "large_codebase"],
      "max_chars_to_provider": 64000,
      "temperature": 0.3
    },
    {
      "job_type": "rewriting",
      "description": "Editing, rephrasing, tone adjustment",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "large_codebase"],
      "max_chars_to_provider": 32000,
      "temperature": 0.6
    },
    {
      "job_type": "documentation",
      "description": "Writing docs, READMEs, user guides",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "structured_json"],
      "forbidden_data": ["images", "large_codebase"],
      "max_chars_to_provider": 48000,
      "temperature": 0.5
    },
    {
      "job_type": "research",
      "description": "Online research, fact-finding, current events",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": true,
      "include_attachments": "none",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "large_codebase"],
      "max_chars_to_provider": 24000,
      "temperature": 0.4
    },
    {
      "job_type": "linguistics",
      "description": "Grammar, translation, language analysis",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "logs"],
      "max_chars_to_provider": 16000,
      "temperature": 0.3
    },
    {
      "job_type": "voice_input",
      "description": "Transcribed voice input processing",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "none",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "large_codebase"],
      "max_chars_to_provider": 8000,
      "temperature": 0.7
    },
    {
      "job_type": "embeddings",
      "description": "Vector embeddings generation for semantic search",
      "primary_provider": "openai",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "none",
      "allowed_data": ["text", "embeddings_request"],
      "forbidden_data": ["images", "videos", "audio"],
      "max_chars_to_provider": 8000,
      "temperature": 0.0,
      "special_endpoint": "embeddings"
    },
    {
      "job_type": "architecture",
      "description": "System design, component architecture, technical decisions",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "structured_json", "design_docs"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 200000,
      "temperature": 0.4,
      "requires_review": true
    },
    {
      "job_type": "deep_planning",
      "description": "Long-horizon planning, roadmaps, multi-step strategies",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "structured_json", "design_docs"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 150000,
      "temperature": 0.5,
      "requires_review": true
    },
    {
      "job_type": "security_review",
      "description": "Security audits, vulnerability analysis, threat modeling",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "structured_json"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 200000,
      "temperature": 0.2,
      "requires_review": true
    },
    {
      "job_type": "complex_code",
      "description": "New feature implementation, complex algorithms, system integration",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "structured_json", "large_codebase"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 300000,
      "temperature": 0.3,
      "requires_review": true
    },
    {
      "job_type": "refactoring",
      "description": "Code restructuring, cleanup, optimization",
      "primary_provider": "anthropic",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "large_codebase"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 200000,
      "temperature": 0.2
    },
    {
      "job_type": "migration",
      "description": "Framework/library/version migrations",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": true,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "structured_json", "large_codebase"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 250000,
      "temperature": 0.3,
      "requires_review": true
    },
    {
      "job_type": "bug_analysis",
      "description": "Bug investigation, crash log analysis, root cause analysis",
      "primary_provider": "anthropic",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs", "structured_json"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 150000,
      "temperature": 0.2
    },
    {
      "job_type": "code_review",
      "description": "PR review, code quality assessment",
      "primary_provider": "anthropic",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 150000,
      "temperature": 0.3
    },
    {
      "job_type": "implementation_plan",
      "description": "Technical specs, implementation blueprints",
      "primary_provider": "anthropic",
      "review_provider": "gemini",
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "structured_json", "design_docs"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 150000,
      "temperature": 0.4,
      "requires_review": true
    },
    {
      "job_type": "bug_fix",
      "description": "Simple bug fixes, error corrections",
      "primary_provider": "anthropic",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "logs"],
      "forbidden_data": ["images", "videos"],
      "max_chars_to_provider": 100000,
      "temperature": 0.2
    },
    {
      "job_type": "vision",
      "description": "Image analysis, screenshot interpretation",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "images", "screenshots"],
      "forbidden_data": [],
      "max_chars_to_provider": 50000,
      "temperature": 0.4,
      "requires_vision": true
    },
    {
      "job_type": "ui_analysis",
      "description": "UI/UX review, layout analysis, accessibility checks",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "images", "screenshots"],
      "forbidden_data": [],
      "max_chars_to_provider": 50000,
      "temperature": 0.4,
      "requires_vision": true
    },
    {
      "job_type": "document_analysis",
      "description": "PDF parsing, structured document extraction",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "pdfs", "images", "structured_json"],
      "forbidden_data": [],
      "max_chars_to_provider": 100000,
      "temperature": 0.3,
      "requires_vision": true
    },
    {
      "job_type": "ocr",
      "description": "Text extraction from images",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "images", "screenshots", "pdfs"],
      "forbidden_data": [],
      "max_chars_to_provider": 20000,
      "temperature": 0.1,
      "requires_vision": true
    },
    {
      "job_type": "video_analysis",
      "description": "Video content analysis, frame extraction",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "videos"],
      "forbidden_data": [],
      "max_chars_to_provider": 30000,
      "temperature": 0.4,
      "requires_vision": true
    },
    {
      "job_type": "web_search",
      "description": "Real-time web search with grounding",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": true,
      "include_attachments": "none",
      "allowed_data": ["text"],
      "forbidden_data": ["images", "code", "large_codebase"],
      "max_chars_to_provider": 16000,
      "temperature": 0.4,
      "special_endpoint": "web_search"
    },
    {
      "job_type": "critique",
      "description": "Critical review, alternative perspectives, devil's advocate",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "code", "structured_json"],
      "forbidden_data": ["images"],
      "max_chars_to_provider": 100000,
      "temperature": 0.5
    },
    {
      "job_type": "analysis",
      "description": "Data analysis, trend identification, pattern recognition",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": true,
      "include_web_search": false,
      "include_attachments": "text_only",
      "allowed_data": ["text", "structured_json", "logs"],
      "forbidden_data": [],
      "max_chars_to_provider": 150000,
      "temperature": 0.4
    },
    {
      "job_type": "cv_parsing",
      "description": "Resume/CV structured extraction",
      "primary_provider": "gemini",
      "review_provider": null,
      "include_semantic_context": false,
      "include_web_search": false,
      "include_attachments": "all",
      "allowed_data": ["text", "pdfs", "images"],
      "forbidden_data": [],
      "max_chars_to_provider": 50000,
      "temperature": 0.2,
      "requires_vision": true
    }
  ],

  "job_type_aliases": {
    "chat": "casual_chat",
    "conversation": "casual_chat",
    "question": "quick_question",
    "qa": "quick_question",
    "brainstorm": "thought_organization",
    "outline": "thought_organization",
    "summary": "summarization",
    "condense": "summarization",
    "edit": "rewriting",
    "rephrase": "rewriting",
    "docs": "documentation",
    "readme": "documentation",
    "search": "research",
    "lookup": "research",
    "grammar": "linguistics",
    "translate": "linguistics",
    "voice": "voice_input",
    "embed": "embeddings",
    "design": "architecture",
    "system_design": "architecture",
    "planning": "deep_planning",
    "roadmap": "deep_planning",
    "security": "security_review",
    "audit": "security_review",
    "feature": "complex_code",
    "implement": "complex_code",
    "refactor": "refactoring",
    "cleanup": "refactoring",
    "migrate": "migration",
    "upgrade": "migration",
    "debug": "bug_analysis",
    "investigate": "bug_analysis",
    "review": "code_review",
    "pr_review": "code_review",
    "spec": "implementation_plan",
    "blueprint": "implementation_plan",
    "fix": "bug_fix",
    "patch": "bug_fix",
    "image": "vision",
    "screenshot": "vision",
    "ui": "ui_analysis",
    "ux": "ui_analysis",
    "pdf": "document_analysis",
    "document": "document_analysis",
    "extract_text": "ocr",
    "video": "video_analysis",
    "grounding": "web_search",
    "web": "web_search",
    "criticize": "critique",
    "review_output": "critique",
    "data": "analysis",
    "trends": "analysis",
    "resume": "cv_parsing",
    "cv": "cv_parsing"
  },

  "validation_rules": {
    "require_vision_for": ["vision", "ui_analysis", "document_analysis", "ocr", "video_analysis", "cv_parsing"],
    "require_web_search_for": ["web_search"],
    "high_stakes_jobs": ["architecture", "deep_planning", "security_review", "complex_code", "migration", "implementation_plan"],
    "vision_capable_providers": ["gemini"],
    "web_search_capable_providers": ["gemini"],
    "embedding_capable_providers": ["openai"]
  }
}